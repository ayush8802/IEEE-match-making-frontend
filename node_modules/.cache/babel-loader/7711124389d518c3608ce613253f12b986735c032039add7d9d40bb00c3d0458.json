{"ast":null,"code":"var _jsxFileName = \"D:\\\\ieee match making\\\\frontend\\\\src\\\\pages\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { supabase } from \"../config/supabase\";\nimport ChatSidebar from \"../components/Chat/ChatSidebar\";\nimport ChatWindow from \"../components/Chat/ChatWindow\";\nimport { useLocation } from \"react-router-dom\";\nimport \"../styles/chat.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [activeUser, setActiveUser] = useState(null);\n  const [messages, setMessages] = useState({}); // { username: [msgs] }\n  const [loading, setLoading] = useState(true);\n  const location = useLocation();\n\n  // Fetch mutual recommendations to populate chat list\n  useEffect(() => {\n    const fetchUsers = async () => {\n      const {\n        data: {\n          user\n        }\n      } = await supabase.auth.getUser();\n      if (!user) return;\n      const {\n        data,\n        error\n      } = await supabase.from(\"questionnaire_responses\").select(\"mutual_recommendation\").eq(\"user_id\", user.id).single();\n      if (error) {\n        console.error(\"Error fetching chat users:\", error);\n      } else if (data && data.mutual_recommendation) {\n        try {\n          var _location$state;\n          const parsed = typeof data.mutual_recommendation === \"string\" ? JSON.parse(data.mutual_recommendation) : data.mutual_recommendation;\n          const userList = Array.isArray(parsed) ? parsed : [];\n          setUsers(userList);\n\n          // Check if navigated with a pre-selected user\n          if ((_location$state = location.state) !== null && _location$state !== void 0 && _location$state.selectedUser) {\n            const preSelected = userList.find(u => u.name === location.state.selectedUser.name);\n            if (preSelected) setActiveUser(preSelected);\n          }\n        } catch (err) {\n          console.error(\"JSON Parse error:\", err);\n        }\n      }\n      setLoading(false);\n    };\n    fetchUsers();\n  }, [location.state]);\n  const handleSelectUser = user => {\n    setActiveUser(user);\n  };\n  const handleSendMessage = text => {\n    if (!activeUser) return;\n    const newMessage = {\n      id: Date.now(),\n      text,\n      sender: 'me',\n      timestamp: new Date().toISOString()\n    };\n    setMessages(prev => {\n      const userMessages = prev[activeUser.name] || [];\n      return {\n        ...prev,\n        [activeUser.name]: [...userMessages, newMessage]\n      };\n    });\n\n    // Simulate reply (optional for \"chat for now\")\n    setTimeout(() => {\n      const reply = {\n        id: Date.now() + 1,\n        text: \"Thanks for reaching out! I'd love to discuss this further.\",\n        sender: 'them',\n        timestamp: new Date().toISOString()\n      };\n      setMessages(prev => {\n        const userMessages = prev[activeUser.name] || [];\n        return {\n          ...prev,\n          [activeUser.name]: [...userMessages, reply]\n        };\n      });\n    }, 1000);\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading-spinner\",\n    children: \"Loading chat...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: [/*#__PURE__*/_jsxDEV(ChatSidebar, {\n      users: users,\n      activeUser: activeUser,\n      onSelectUser: handleSelectUser\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ChatWindow, {\n      activeUser: activeUser,\n      messages: messages[activeUser === null || activeUser === void 0 ? void 0 : activeUser.name] || [],\n      onSendMessage: handleSendMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n}\n_s(Chat, \"qmKEVno7tP6Ad4PvEdGv7+2QOgQ=\", false, function () {\n  return [useLocation];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","supabase","ChatSidebar","ChatWindow","useLocation","jsxDEV","_jsxDEV","Chat","_s","users","setUsers","activeUser","setActiveUser","messages","setMessages","loading","setLoading","location","fetchUsers","data","user","auth","getUser","error","from","select","eq","id","single","console","mutual_recommendation","_location$state","parsed","JSON","parse","userList","Array","isArray","state","selectedUser","preSelected","find","u","name","err","handleSelectUser","handleSendMessage","text","newMessage","Date","now","sender","timestamp","toISOString","prev","userMessages","setTimeout","reply","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSelectUser","onSendMessage","_c","$RefreshReg$"],"sources":["D:/ieee match making/frontend/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { supabase } from \"../config/supabase\";\r\nimport ChatSidebar from \"../components/Chat/ChatSidebar\";\r\nimport ChatWindow from \"../components/Chat/ChatWindow\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport \"../styles/chat.css\";\r\n\r\nexport default function Chat() {\r\n    const [users, setUsers] = useState([]);\r\n    const [activeUser, setActiveUser] = useState(null);\r\n    const [messages, setMessages] = useState({}); // { username: [msgs] }\r\n    const [loading, setLoading] = useState(true);\r\n    const location = useLocation();\r\n\r\n    // Fetch mutual recommendations to populate chat list\r\n    useEffect(() => {\r\n        const fetchUsers = async () => {\r\n            const { data: { user } } = await supabase.auth.getUser();\r\n            if (!user) return;\r\n\r\n            const { data, error } = await supabase\r\n                .from(\"questionnaire_responses\")\r\n                .select(\"mutual_recommendation\")\r\n                .eq(\"user_id\", user.id)\r\n                .single();\r\n\r\n            if (error) {\r\n                console.error(\"Error fetching chat users:\", error);\r\n            } else if (data && data.mutual_recommendation) {\r\n                try {\r\n                    const parsed = typeof data.mutual_recommendation === \"string\"\r\n                        ? JSON.parse(data.mutual_recommendation)\r\n                        : data.mutual_recommendation;\r\n\r\n                    const userList = Array.isArray(parsed) ? parsed : [];\r\n                    setUsers(userList);\r\n\r\n                    // Check if navigated with a pre-selected user\r\n                    if (location.state?.selectedUser) {\r\n                        const preSelected = userList.find(u => u.name === location.state.selectedUser.name);\r\n                        if (preSelected) setActiveUser(preSelected);\r\n                    }\r\n                } catch (err) {\r\n                    console.error(\"JSON Parse error:\", err);\r\n                }\r\n            }\r\n            setLoading(false);\r\n        };\r\n\r\n        fetchUsers();\r\n    }, [location.state]);\r\n\r\n    const handleSelectUser = (user) => {\r\n        setActiveUser(user);\r\n    };\r\n\r\n    const handleSendMessage = (text) => {\r\n        if (!activeUser) return;\r\n\r\n        const newMessage = {\r\n            id: Date.now(),\r\n            text,\r\n            sender: 'me',\r\n            timestamp: new Date().toISOString()\r\n        };\r\n\r\n        setMessages(prev => {\r\n            const userMessages = prev[activeUser.name] || [];\r\n            return {\r\n                ...prev,\r\n                [activeUser.name]: [...userMessages, newMessage]\r\n            };\r\n        });\r\n\r\n        // Simulate reply (optional for \"chat for now\")\r\n        setTimeout(() => {\r\n            const reply = {\r\n                id: Date.now() + 1,\r\n                text: \"Thanks for reaching out! I'd love to discuss this further.\",\r\n                sender: 'them',\r\n                timestamp: new Date().toISOString()\r\n            };\r\n            setMessages(prev => {\r\n                const userMessages = prev[activeUser.name] || [];\r\n                return {\r\n                    ...prev,\r\n                    [activeUser.name]: [...userMessages, reply]\r\n                };\r\n            });\r\n        }, 1000);\r\n    };\r\n\r\n    if (loading) return <div className=\"loading-spinner\">Loading chat...</div>;\r\n\r\n    return (\r\n        <div className=\"chat-container\">\r\n            <ChatSidebar\r\n                users={users}\r\n                activeUser={activeUser}\r\n                onSelectUser={handleSelectUser}\r\n            />\r\n            <ChatWindow\r\n                activeUser={activeUser}\r\n                messages={messages[activeUser?.name] || []}\r\n                onSendMessage={handleSendMessage}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}